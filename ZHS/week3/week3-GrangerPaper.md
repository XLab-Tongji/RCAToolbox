# Discovery of Causal Time Intervals

## Introduction
### Idea
Granger测试是基于预测的:给定一对时间序列X、Y,利用整个时间序列拟合了两种不同的预测模型:全模型和简化模型
- 全模型:使用X过去的值和Y过去的值来预测Y
- 简化模型:只使用Y过去的值来预测Y

若全模型预测效果显著好于简化模型,则称X Granger cause Y

### 真实情况
因果相关可能只出现在部分时间序列中,因此需要找到因果关系的时间区间

### 论文方法
- 关键观点:相似的时间区间很可能会有相似的Granger测试结果
- 实践:给定一个时间区间的拟合模型,能够导出类似时间区间的Granger测试统计显著性的上下界,该边界可以用来在不拟合实际模型的同时,快速识别不能通过测试的时间区间

> 即确定阈值,进行剪枝

### 主要贡献
- 第一个基于Granger测试检验时间序列因果关系的
- 提出了一种有效的算法,利用回归误差的边界来避免在相似时间区间上对Granger检验进行不必要的计算.

## Baseline

## 论文方法
使用双边Granger测试来决定因果关系

### Granger因果测试
- F检验
$$F =  \frac{(SSE_r-SSE_f)/L}{SSE_f/(T-2L-1)}$$
在零假设下,F统计量服从参数L、T-2L-1的F分布,若从数据中算出的F统计量大于某个期望的误拒绝(false-rejection)概率的F分布的临界值,则零假设被推翻

- **定义3.1**
给定两个时间序列X和Y,以及时间滞后参数L,则:
 
如果上式的F统计量比某个期望下的误拒绝概率F分布的临界值,则称X Granger cause Y

### 双边Granger因果
如果X Granger cause Y且Y Granger cause X,则有可能存在第三个变量需要被控制,或它才是更好的候选变量.

**定义3.2**
给定两个时间序列X和Y,以及时间滞后参数L,则X cause Y当且仅当:
- X和Y固定不动 且
- X Granger cause Y 且
- Y not Granger cause X

## 高效算法
### 主要观点
很多时候没有必要精确计算某一区间的SSE和F统计量,共享样本的模型可以利用一个估算另一个的F统计量边界,并进行剪枝
### 剪枝算法
> TODO

